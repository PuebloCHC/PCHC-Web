<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCHC</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

  <header>
    <nav>
      <h1 class="logo">PCHC</h1>
      <ul>
        <li><a href="#about">About</a></li>
        <li><a href="announcements.html">Announcements</a></li>
        <li><a href="calendar.html">Calendar</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </nav>
    <section class="hero">
      <h2>Welcome to PCHC</h2>
      <p class="tagline">Praise The Lord!</p>
      <a href="announcements.html" class="btn">View Announcements</a>
    </section>
  </header>

  <main>
    <section id="about">
      <h2>About Us</h2>
      <p>We are all about healing the land of Pueblo through a relationship with Jesus Christ!</p>
    </section>

    <section id="announcements">
      <h2>Announcements</h2>
      <ul class="announcement-list">
        <script>
            const apiKey = 'AIzaSyA18ZEh4f1NIseKFpZ0IYw3qS5sC_Wb1rc';
            const calendarId = 'mypueblochc@gmail.com'; // Make sure it's public!
          
            const now = new Date();
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay()));
            const endOfWeek = new Date(now.setDate(startOfWeek.getDate() + 6));
            
            const isoStart = startOfWeek.toISOString();
            const isoEnd = endOfWeek.toISOString();
          
            fetch(`https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?key=${apiKey}&timeMin=${isoStart}&timeMax=${isoEnd}&singleEvents=true&orderBy=startTime`)
              .then(response => response.json())
              .then(data => {
                const list = document.querySelector('.announcement-list');
                list.innerHTML = ''; // Clear existing static items
          
                if (data.items.length === 0) {
                  list.innerHTML = '<li>No events this week.</li>';
                  return;
                }
          
                data.items.forEach(event => {
                  const date = new Date(event.start.dateTime || event.start.date);
                  const formattedDate = date.toLocaleDateString(undefined, { day: '2-digit', month: 'short', year: 'numeric' });
                  const time = event.start.dateTime ? ` - ${date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}` : '';
                  list.innerHTML += `<li>${formattedDate}${time} - ${event.summary}</li>`;
                });
              })
              .catch(error => {
                console.error('Error fetching calendar events:', error);
              });
          </script>
          
      </ul>
    </section>

    <section id="contact">
      <h2>Contact</h2>
      <p>Email us at <a href="mailto:mypueblochc@gmail.com"> mypueblochc@gmail.com </a></p>
    </section>
  </main>

  <footer>
    <p>Â© 2025 PCHC. All rights reserved.</p>
  </footer>

  
</body>
</html>
